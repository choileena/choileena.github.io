<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>My god, it’s full of STARs!   Using Astrology to Enhance Your Results!</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Generalized Additive Models and Beyond">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="My god, it’s full of STARs!   Using Astrology to Enhance Your Results!" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/workshops/stars/" />
  <meta property="og:image" content="https://m-clark.github.io/workshops/stars/img/nineteeneightyR.png" />
  <meta property="og:description" content="Generalized Additive Models and Beyond" />
  <meta name="github-repo" content="m-clark/stars/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="My god, it’s full of STARs!   Using Astrology to Enhance Your Results!" />
  
  <meta name="twitter:description" content="Generalized Additive Models and Beyond" />
  <meta name="twitter:image" content="https://m-clark.github.io/workshops/stars/img/nineteeneightyR.png" />



<meta name="date" content="2017-04-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="preface.html">
<link rel="next" href="polynomial-regression.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="libs/plotlyjs-1.16.3/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.16.3/plotly-latest.min.js"></script>
<script src="libs/plotly-binding-4.5.6/plotly.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-core-bootstrap-1.10.12/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="libs/dt-core-bootstrap-1.10.12/css/dataTables.bootstrap.extra.css" rel="stylesheet" />
<script src="libs/dt-core-bootstrap-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="libs/dt-core-bootstrap-1.10.12/js/dataTables.bootstrap.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="standard_html.css" type="text/css" />
<link rel="stylesheet" href="stars.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://m-clark.github.io/workshops/stars/"><span style="font-size:125%; font-variant:small-caps; font-style:italic; color:#ff5503">STARS</span></a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#audience"><i class="fa fa-check"></i>Audience</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#goal"><i class="fa fa-check"></i>Goal</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#workshop-setup"><i class="fa fa-check"></i>Workshop Setup</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#other"><i class="fa fa-check"></i>Other</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="why-not-just-use-standard-methods.html"><a href="why-not-just-use-standard-methods.html"><i class="fa fa-check"></i>Why not just use standard methods?</a><ul>
<li class="chapter" data-level="" data-path="why-not-just-use-standard-methods.html"><a href="why-not-just-use-standard-methods.html#heteroscedasticity-non-normality-etc."><i class="fa fa-check"></i>Heteroscedasticity, non-normality etc.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="polynomial-regression.html"><a href="polynomial-regression.html"><i class="fa fa-check"></i>Polynomial Regression</a><ul>
<li class="chapter" data-level="" data-path="polynomial-regression.html"><a href="polynomial-regression.html#a-more-complex-relationship"><i class="fa fa-check"></i>A more complex relationship</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html"><i class="fa fa-check"></i>Building up to GAMs</a><ul>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html#piecewise-polynomial"><i class="fa fa-check"></i>Piecewise polynomial</a></li>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html#introducing-gams-1"><i class="fa fa-check"></i>Introducing GAMs</a></li>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html#polynomial-spline"><i class="fa fa-check"></i>Polynomial spline</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="practical-gam.html"><a href="practical-gam.html"><i class="fa fa-check"></i>Practical GAM</a><ul>
<li class="chapter" data-level="" data-path="practical-gam.html"><a href="practical-gam.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="practical-gam.html"><a href="practical-gam.html#fitting-the-model"><i class="fa fa-check"></i>Fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i>Issues</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i>Extensions</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#extensions-1"><i class="fa fa-check"></i>Extensions</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#connections-generalizations"><i class="fa fa-check"></i>Connections &amp; Generalizations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html"><i class="fa fa-check"></i>Technical details</a><ul>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#gam-introduction"><i class="fa fa-check"></i>GAM Introduction</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#a-detailed-example"><i class="fa fa-check"></i>A detailed example</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#the-number-of-knots-and-where-to-put-them."><i class="fa fa-check"></i>The number of knots and where to put them.</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#interpreting-output-for-smooth-terms"><i class="fa fa-check"></i>Interpreting output for smooth terms</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://m-clark.github.io" target="blank" style="font-size:150%; font-variant:small-caps; color:#ff5500">Michael Clark</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My god, it’s full of STARs! <br> <span style="font-size:50%">Using Astrology to Enhance <strong><em>Your</em></strong> Results!</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="why-not-just-use-standard-methods" class="section level1">
<h1>Why not just use standard methods?</h1>
<p>The standard linear model is ubiquitous in statistical training and application, and for good reason. It is simple to do and easy to understand. Let’s go ahead and do one to get things started.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod =<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x1 +<span class="st"> </span>x2, <span class="dt">data=</span>dat)
<span class="kw">summary</span>(mod)</code></pre></div>
<table style="width:78%;">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="16%" />
<col width="16%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">term</th>
<th align="center">estimate</th>
<th align="center">std.error</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(Intercept)</td>
<td align="center">7.27</td>
<td align="center">0.33</td>
<td align="center">21.83</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">x1</td>
<td align="center">6.36</td>
<td align="center">0.44</td>
<td align="center">14.62</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">x2</td>
<td align="center">-5.12</td>
<td align="center">0.45</td>
<td align="center">-11.31</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:15%;">
<colgroup>
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">r.squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.46</td>
</tr>
</tbody>
</table>
<p>Everything is nice and tidy. We have straightforward information, positive effect of <code>x1</code>, negative for <code>x2</code>, and familiar output. Depending on your context, the R<sup>2</sup> may or may not be something exciting. Let’s look at some diagnostics<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>.</p>
<p><img src="stars_files/figure-html/lmdiag-1.svg" width="768" style="display: block; margin: auto;" /></p>
<p>Some issues might be present, as we might be getting a little more variance with some, especially higher, fitted values. We’re also a little loose in the tails of the distribution of the residuals. Let’s compare our predictions to the data. With a strong model we might see a cigar shaped cloud converging to a line with slope 1 as the fit gets better. We seem to be having some issues here, as the residual plot noted above.</p>
<p><img src="stars_files/figure-html/plotlmfit-1.svg" width="768" style="display: block; margin: auto;" /></p>
<p>Now let’s go back and visualize the data. The following plots both predictors against the target variable.</p>
<p><img src="stars_files/figure-html/covariatePlot-1.svg" width="768" style="display: block; margin: auto;" /></p>
<p>Yikes. We certainly have a positive effect for x1, but it looks rather curvy. The other predictor doesn’t appear to have a relationship that could be classified as easily. It is sharply positive for low values of x2, but negative thereafter, though not in a straightforward fashion.</p>
<div id="heteroscedasticity-non-normality-etc." class="section level2">
<h2>Heteroscedasticity, non-normality etc.</h2>
<p>In many cases as above, people have some standby methods for dealing with the problem. For example, they might see the qqplot for the residuals and think some of those cases are ‘outliers’, perhaps even dropping them from analysis. Others might try a transformation of the target variable, for example, in cases of heteroscedasticity (not because of non-normality!) some might take the log.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modlog =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) ~<span class="st"> </span>x1 +<span class="st"> </span>x2, dat)
<span class="kw">summary</span>(modlog)</code></pre></div>
<table style="width:78%;">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="16%" />
<col width="16%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">term</th>
<th align="center">estimate</th>
<th align="center">std.error</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(Intercept)</td>
<td align="center">1.83</td>
<td align="center">0.05</td>
<td align="center">33.84</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">x1</td>
<td align="center">0.94</td>
<td align="center">0.07</td>
<td align="center">13.29</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">x2</td>
<td align="center">-0.69</td>
<td align="center">0.07</td>
<td align="center">-9.37</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:15%;">
<colgroup>
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">r.squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.4</td>
</tr>
</tbody>
</table>
<p>Well, our fit in terms of R<sup>2</sup> has actually gone down. Let’s check the diagnostics.</p>
<p><img src="stars_files/figure-html/loglmdiag-1.svg" width="768" style="display: block; margin: auto;" /></p>
<p>The transformation may have helped in some ways, but made other things worse.</p>
<p><img src="stars_files/figure-html/plotloglmfit-1.svg" width="768" style="display: block; margin: auto;" /></p>
<p>We continue to see some poor fitting cases and now our fit is flattening even more than it was.</p>
<p>This is a fairly typical result. Transformations often exacerbate data issues or fail to help. What’s more, some of them lead to more difficult interpretation, or aren’t even applicable (e.g. categorical, ordinal targets).</p>
<p>Outliers, if there was actually a standard for deeming something as such, are just indications that your model doesn’t capture the data generating process in some fashion. Cutting data out of the modeling process for that reason hasn’t been acceptable for a long time (if it ever was).</p>
<p>Data abounds where a standard linear model performs poorly or doesn’t do a good enough job capturing the nuances of the data. There may be nonlinear relationships as above, dependency in the observations, known non-Gaussian data etc. One should be prepared to use models better suited to the situation, rather than torturing the data to fit a simplified modeling scheme.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>In case you are wondering, yes, these diagnostic plots are in fact base R graphics, and they still can look good with some work.<a href="why-not-just-use-standard-methods.html#fnref1">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preface.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="polynomial-regression.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "san-serif",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02_lm.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
},
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
